"use strict";function ffalse(){return!1}function ftrue(){return!0}function lightbox_open(a,b,c){"undefined"!=typeof c&&$(["#popup_",a].join("")).html(c),$(["#popup_",a].join("")).fadeIn(fad_Duration),$("#fade").fadeIn(fad_Duration),$("#fade").click(function(){lightbox_close(a)}),$(["#popup_",a].join("")).click(function(){lightbox_close(a)}),tempo=setTimeout(function(){lightbox_close(a)},b)}function lightbox_close(a){$(["#popup_",a].join("")).fadeOut(fad_Duration),$("#fade").fadeOut(fad_Duration),$("#fade").off("click"),$(["#popup_",a].join("")).off("click"),clearTimeout(tempo)}function showPanel(){$("#popup_secpanel").html(['<object type="text/html" data="',$.domoticzurl,'/secpanel/index.html" width="100%" height="100%"></object>'].join("")),$("#popup_secpanel").fadeIn(fad_Duration),$("#fade").fadeIn(fad_Duration),$("#fade").click(closePanel),tempo=setTimeout(closePanel,6e4)}function closePanel(){$("#popup_secpanel").fadeOut(fad_Duration),$("#fade").fadeOut(fad_Duration),$("#fade").off("click"),$("#popup_secpanel").empty(),clearTimeout(tempo)}function showFreeRemote(){$("#popup_freeRemote").fadeIn(fad_Duration),$("#fade").fadeIn(fad_Duration),$("#fade").click(closeFreeRemote),tempo=setTimeout(closeFreeRemote,6e4)}function closeFreeRemote(){$("#popup_freeRemote").fadeOut(fad_Duration),$("#fade").fadeOut(fad_Duration),$("#fade").off("click"),clearTimeout(tempo)}function showRange(){$("#popup_range").fadeIn(fad_Duration),$("#fade").fadeIn(fad_Duration),$("#fade").click(closeRange),tempo=setTimeout(closeRange,6e4)}function closeRange(){$("#popup_range").fadeOut(fad_Duration),$("#fade").fadeOut(fad_Duration),$("#fade").off("click"),clearTimeout(tempo)}function LoadMeteoWidget(){""===city?($("#popup_meteo0").html("<span>Veuillez indiquer votre ville dans les paramètres<br>exemple:<br>var city = 'paris'</span>"),$("#popup_meteo1").html("<span>Veuillez indiquer votre ville dans les paramètres<br>exemple:<br>var city = 'paris'</span>"),$("#popup_meteo2").html("<span>Veuillez indiquer votre ville dans les paramètres<br>exemple:<br>var city = 'paris'</span>"),$("#popup_meteo3").html("<span>Veuillez indiquer votre ville dans les paramètres<br>exemple:<br>var city = 'paris'</span>")):($("#popup_meteo0").html(['<img src="http://www.prevision-meteo.ch/uploads/widget/',city,"_0.png?timestamp=",Date.now(),'" alt="Ville inconnue..">'].join("")),$("#popup_meteo1").html(['<img src="http://www.prevision-meteo.ch/uploads/widget/',city,"_1.png?timestamp=",Date.now(),'" alt="Ville inconnue..">'].join("")),$("#popup_meteo2").html(['<img src="http://www.prevision-meteo.ch/uploads/widget/',city,"_2.png?timestamp=",Date.now(),'" alt="Ville inconnue..">'].join("")),$("#popup_meteo3").html(['<img src="http://www.prevision-meteo.ch/uploads/widget/',city,"_3.png?timestamp=",Date.now(),'" alt="Ville inconnue..">'].join(""))),""===place?$("#popup_meteo4").html("<span>Veuillez indiquer votre ville dans les paramètres<br>exemple:<br>var place = 'France/Brittany/Paris'</span>"):$("#popup_meteo4").html(['<img src="http://www.yr.no/place/',place,"/avansert_meteogram.png?timestamp=",Date.now(),'" alt="Ville inconnue..">'].join(""))}function RefreshGraphData(a,b,c,d,e,f,g){$.ajax({url:[$.domoticzurl,"/json.htm?type=graph&sensor=",d,"&idx=",b,"&range=",e,"&jsoncallback=?"].join("")}).done(function(b){var d=[],e=[],h=[];"p1"===f?($.each(b.result,function(a,b){var c=parseInt(b.d.substring(0,4)),f=parseInt(b.d.substring(5,7)),g=parseInt(b.d.substring(8,10)),h=parseInt(b.d.substring(11,13)),i=parseInt(b.d.substring(14,16)),j=Date.UTC(c,f-1,g,h,i),k=[j,parseFloat(b.v)],l=[j,parseFloat(b.v2)];d.push(k),e.push(l)}),h=[{data:d,borderWidth:2},{data:e,borderWidth:2}]):($.each(b.result,function(a,b){var c=parseInt(b.d.substring(0,4)),e=parseInt(b.d.substring(5,7)),g=parseInt(b.d.substring(8,10)),h=parseInt(b.d.substring(11,13)),i=parseInt(b.d.substring(14,16)),j=Date.UTC(c,e-1,g,h,i),k=[j,parseFloat(b[f])];d.push(k)}),h=[{data:d,borderWidth:2}]),createGraph(a,h,c,g)})}function createGraph(a,b,c,d){$(a).highcharts({chart:{type:"line",zoomType:"none",animation:!1,reflow:!1},plotOptions:{line:{animation:!1,enableMouseTracking:!1,stickyTracking:!0,shadow:!1,dataLabels:{style:{textShadow:!1}}}},subtitle:{text:""},title:{text:c},tooltip:{formatter:function(){return["<b>",y,"</b>"].join("")}},legend:{enabled:!1},credits:{enabled:!1},xAxis:{type:"datetime",minRange:36e5,title:{text:"time",opposite:!0}},yAxis:{title:{text:d,opposite:!0}},series:b}),"#popup_graph"===a&&lightbox_open("graph",25400)}function func(a,b,c,d,e){istrue=!0,timer=setTimeout(function(){makeChange(a,c,d,e)},delay),b.preventDefault?b.preventDefault():b.returnValue=!1}function makeChange(a,b,c,d){timer&&clearTimeout(timer),istrue&&(isNaN(b)&&(b=0),$("#popup_range").html(""),$("#popup_range").append("<p>"),$("#popup_range").append('<label for="amount">'+c+": </label>"),$("#popup_range").append('<input type="text" id="amount" readonly size="2">'),$("#popup_range").append("<p>"),$("#popup_range").append('<div id="slider-H"></div>'),$("#slider-H").slider({orientation:"horisontal",range:"min",min:0,max:100,value:b,step:100/d,slide:function(a,b){$("#amount").val(parseInt(b.value)+" %")},change:function(b,c){var e=Math.round(1+parseInt(c.value)/100*d);e<0&&(e=0),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",a,"&switchcmd=Set Level&level=",e].join(""),success:function(a){"WRONG CODE"===a.message?console.warn("WRONG CODE"):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):console.log(a)},error:function(a){console.warn(a.status)}})}}),$("#amount").val(parseInt($("#slider-H").slider("value"))+" %"),showRange())}function revert(){istrue=!1}function RefreshData(){clearTimeout(refreshTimer),console.log("%cPage refresh","color: blue","\n"),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=getSunRiseSet&jsoncallback=?"].join(""),success:function(a){var b=new Date;"undefined"!=typeof a?$.each(a,function(a,b){"Sunrise"===a?(console.log("sunrise: ",b),var_sunrise=b.substring(0,5)):"Sunset"===a&&(console.log("sunset: ",b),var_sunset=b.substring(0,5))}):console.log("Undefined");var c=new Date,d=c.getDate().toString();d=d.trim(),1===d.length&&(d=["0",d].join(""));var e=(c.getMonth()+1).toString();e=e.trim(),1===e.length&&(e=["0",e].join(""));var f=[e,d].join("");f>="1222"?(console.log("season: winter"),"undefined"!=typeof bg_day_winter&&""!==bg_day_winter&&(bg_day=bg_day_winter),"undefined"!=typeof bg_night_winter&&""!==bg_night_winter&&(bg_night=bg_night_winter)):f>="0923"?(console.log("season: autumn"),"undefined"!=typeof bg_day_autumn&&""!==bg_day_autumn&&(bg_day=bg_day_autumn),"undefined"!=typeof bg_night_autumn&&""!==bg_night_autumn&&(bg_night=bg_night_autumn)):f>="0621"?(console.log("season: summer"),"undefined"!=typeof bg_day_summer&&""!==bg_day_summer&&(bg_day=bg_day_summer),"undefined"!=typeof bg_night_summer&&""!==bg_night_summer&&(bg_night=bg_night_summer)):f>="0319"?(console.log("season: spring"),"undefined"!=typeof bg_day_spring&&""!==bg_day_spring&&(bg_day=bg_day_spring),"undefined"!=typeof bg_night_spring&&""!==bg_night_spring&&(bg_night=bg_night_spring)):(console.log("season: winter"),"undefined"!=typeof bg_day_winter&&""!==bg_day_winter&&(bg_day=bg_day_winter),"undefined"!=typeof bg_night_winter&&""!==bg_night_winter&&(bg_night=bg_night_winter));var g=c.getHours(),h=c.getMinutes(),i=var_sunrise.split(":"),j=var_sunset.split(":"),k=60*g+h,l=60*+i[0]+ +i[1],m=60*+j[0]+ +j[1];k>m||k<l?(IsNight=!0,"undefined"!=typeof bg_night&&""!==bg_night&&($("#black").css("background",["rgba(0,0,0,",bg_nightBright,")"].join("")),document.body.style.background=["black url(icons/",bg_night,") no-repeat top center fixed"].join(""),document.body.style.backgroundSize=bg_size),$(".horloge").length>0&&($(".horloge").hasClass("day")&&$(".horloge").removeClass("day"),$(".horloge").hasClass("night")||$(".horloge").addClass("night"))):(IsNight=!1,"undefined"!=typeof bg_day&&""!==bg_day&&($("#black").css("background",["rgba(0,0,0,",bg_dayBright,")"].join("")),document.body.style.background=["black url(icons/",bg_day,") no-repeat top center fixed"].join(""),document.body.style.backgroundSize=bg_size),$(".horloge").length>0&&($(".horloge").hasClass("night")&&$(".horloge").removeClass("night"),$(".horloge").hasClass("day")||$(".horloge").addClass("day"))),console.log("%cConnecting to domoticz : Success","color: green","\n"),0!=error&&(error=0,GetCams()),"block"===$("#popup_offline").css("display")&&($("#popup_offline").fadeOut(fad_Duration),$("#fade2").fadeOut(fad_Duration)),b=new Date-b,console.log("Get sunset/background/clock/meteo: "+b+"ms")},error:function(){error+=1,console.log(["ERROR connect to ",$.domoticzurl].join("")),error>=10&&"none"===$("#popup_offline").css("display")?($("#popup_offline").fadeIn(fad_Duration),$("#fade2").fadeIn(fad_Duration)):RefreshData()}}),$.ajax({url:[$.domoticzurl,"/json.htm?type=devices&plan=",$.roomplan,"&jsoncallback=?"].join(""),success:function(data){var two=new Date;"undefined"!=typeof data.result&&$.each(data.result,function(i,item){var ii=0,len=$.PageArray.length;jsKata.nofreeze.forloop(function(){return ii<len-1},function(){ii++},function fct(){if($.PageArray[ii][0]===item.idx||$.PageArray[ii][0]===item.Name){var vtype=$.PageArray[ii][1],vlabel=$.PageArray[ii][2],vdesc=$.PageArray[ii][3],lastseen=$.PageArray[ii][4],vplusmin=$.PageArray[ii][5],vattr=$.PageArray[ii][6],valarm=$.PageArray[ii][7],vdata=item[vtype],vstatus=item.Status,vls=item.LastUpdate,vdimmercurrent=item.LevelInt;"Euro"===vtype&&(vdata=item.Data),"undefined"==typeof vdata?vdata="?!":"Text"!==item.SubType&&(vdata=String(vdata).split("Watt",1)[0],vdata=String(vdata).split("kWh",1)[0],vdata=String(vdata).split("km",1)[0],vdata=String(vdata).split("Liter",1)[0],vdata=String(vdata).split("V",1)[0],vdata=String(vdata).split("%",1)[0],vdata=String(vdata).split(" Level:",1)[0],vdata=String(vdata).split("m3",1)[0],vdata=String(vdata).split("Lux",1)[0],vdata=String(vdata).replace("Set","On"),vdata=String(vdata).replace("true","protected")),"undefined"!=typeof vattr&&""===vattr&&(vattr=void 0);var switchclick,alarmcss,val,plus,min;if("Push On Button"===item.SwitchType&&(vdata="Off"),"Push Off Button"===item.SwitchType&&(vdata="On"),"undefined"!=typeof lastseen&&""!==lastseen||(lastseen="0"),"ForecastStr"!==vtype&&("1"===lastseen||"3"===lastseen)&&$(["#ls_",vlabel].join("")).length>0&&$(["#ls_",vlabel].join("")).html(vls),"Wakeup"===vtype)vdata=goodmorning(item.Data);else if("Graph"===vtype)RefreshGraphData("#"+vlabel,item.idx,vdesc,lastseen,vplusmin,vattr,valarm),vdata=vdesc="";else if("Level"===vtype&&"Dimmer"===item.SwitchType)"Off"===vstatus?(alarmcss="color:#E24E2A;",vdata=txt_off):alarmcss="color:#1B9772;",vdata===txt_off?(val="2"===lastseen?['<img src="',$.domoticzurl,'/images/Light48_Off.png" width=48 onclick="SwitchToggle(',item.idx,", 'On',",txt_switch_on,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">"].join(""):['<span onclick="SwitchToggle(',item.idx,", 'On',",txt_switch_on,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">",vdata,"</span>"].join(""),plus="",min=""):100===item.MaxDimLevel?("2"===lastseen?(val=['<img src="',$.domoticzurl,'/images/Light48_On.png" width=48 onclick="SwitchToggle(',item.idx,", 'Off',",txt_switch_off,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">"].join(""),vdesc=[vdesc,'<span class="percent">',vdata,'<span style="font-size:70%;"> &#37;</span></span>'].join("")):val=['<span onclick="SwitchToggle(',item.idx,", 'Off',",txt_switch_off,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">",vdata,"</span>"].join(""),plus=["<img src=icons/plus.png align=right hspace=10 vspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png align=left hspace=10 vspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join("")):("2"===lastseen?(val=['<img src="',$.domoticzurl,'/images/Light48_On.png" width=48 onclick="SwitchToggle(',item.idx,", 'Off',",txt_switch_off,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">"].join(""),vdesc=[vdesc,'<span class="percent">',vdata,'<span style="font-size:70%;"> &#37;</span></span>'].join("")):val=['<span onclick="SwitchToggle(',item.idx,", 'Off',",txt_switch_off,",",item.Protected,')" onmousedown="func(',item.idx,",event,'",vdata,"','",vdesc,"',",item.MaxDimLevel,')" onmouseup="revert()" style=',alarmcss,">",vdata,"</span>"].join(""),plus=["<img src=icons/plus.png align=right hspace=10 vspace=4 width=30 onclick=\"DimLevel16('plus',",vdata,",",item.idx,",",vdimmercurrent,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png align=left hspace=10 vspace=4 width=30 onclick=\"DimLevel16('min',",vdata,",",item.idx,",",vdimmercurrent,",",item.Protected,')">'].join("")),vdata=[min,val,plus].join("");else if("Level"===vtype&&"Selector"===item.SwitchType){var mots=item.LevelNames.split("|");for(i=0;i<mots.length;i++)i==parseInt(item.Level)/10&&(vdata=mots[i]);switchclick=['onclick="ShowSelector(',item.idx,",'",item.LevelNames,"',",item.LevelOffHidden,",",item.Protected,')"'].join("")}else if("SetPoint"===vtype&&vplusmin>0)val=["<span style=",vattr,">",vdata,"</span>"].join(""),plus=vdata>=valarm?["<img src=icons/plusRed.png align=right vspace=4 width=30 onclick=\"ChangeTherm('plus',",vplusmin,",",item.idx,",",vdata,",",valarm,",",item.Protected,')">'].join(""):["<img src=icons/plus.png align=right vspace=4 width=30 onclick=\"ChangeTherm('plus',",vplusmin,",",item.idx,",",vdata,",",valarm,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png align=left vspace=4 width=30 onclick=\"ChangeTherm('min',",vplusmin,",",item.idx,",",vdata,",",valarm,",",item.Protected,')">'].join(""),vdata=[min,val,plus].join("");else if("Blinds"===item.SwitchType){if("Closed"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");else if("Open"===vdata||"Stopped"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");var stop=["<img src=",$.domoticzurl,'/images/blindsstop.png  hspace=1 height=40 onclick="SwitchToggle(',item.idx,", 'Stop',",txt_blind_stop,",",item.Protected,')">'].join("");vdata="RFY"===item.Type?[down,stop,up].join(""):[down,up].join("")}else if("Blinds Inverted"===item.SwitchType){if("Closed"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_up,",",item.Protected,')">'].join("");else if("Open"===vdata||"Stopped"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src="+$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_up,",",item.Protected,')">'].join("");var stop=["<img src=",$.domoticzurl,'/images/blindsstop.png  hspace=1 height=40 onclick="SwitchToggle(',item.idx,", 'Stop',",txt_blind_stop,",",item.Protected,')">'].join("");vdata="RFY"===item.Type?[down,stop,up].join(""):[down,up].join("")}else if("Venetian Blinds EU"===item.SwitchType||"Venetian Blinds US"===item.SwitchType){if("Closed"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");else if("Open"===vdata||"Stopped"===vdata)var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");var stop=["<img src=",$.domoticzurl,'/images/blindsstop.png  hspace=1 height=40 onclick="SwitchToggle(',item.idx,", 'Stop',",txt_blind_stop,",",item.Protected,')">'].join("");vdata=[down,stop,up].join("")}else if("Blinds Percentage"===item.SwitchType){if("Closed"===item.Status){vdata=100;var down=["<img src=",$.domoticzurl,'/images/blinds48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join("")}else if("Open"===item.Status){var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join("")}else{var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png  vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join("")}vdesc=[vdesc,'<span class="percent">',100-vdata,'<span style="font-size:50%;"> &#37;</span></span>'].join(""),vdata=[min,down,up,plus].join("")}else if("Blinds Percentage Inverted"===item.SwitchType){if("Closed"===item.Status){var down=["<img src=",$.domoticzurl,'/images/blinds48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join("")}else if("Open"===item.Status){vdata=100;var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join("")}else{var down=["<img src=",$.domoticzurl,'/images/blinds48.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'Off',",txt_blind_down,",",item.Protected,')">'].join(""),up=["<img src=",$.domoticzurl,'/images/blindsopen48sel.png  hspace=1 width=40 onclick="SwitchToggle(',item.idx,", 'On',",txt_blind_up,",",item.Protected,')">'].join("");plus=["<img src=icons/plus.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('plus',",vdata,",",item.idx,",",item.Protected,')">'].join(""),min=["<img src=icons/min.png vspace=4 hspace=4 width=30 onclick=\"DimLevel100('min',",vdata,",",item.idx,",",item.Protected,')">'].join("")}vdesc=[vdesc,'<span class="percent">',vdata,'<span style="font-size:50%;"> &#37;</span></span>'].join(""),vdata=[min,down,up,plus].join("")}else"ForecastStr"===vtype?(switchclick=["onclick=\"lightbox_open('meteo",lastseen,"',25400)\""].join(""),vdata=IsNight?["<img src=icons/meteo/night/",vdata.slice(0,3),".png width=155 height=155>"].join(""):["<img src=icons/meteo/day/",vdata.slice(0,3),".png width=155 height=155>"].join("")):"Security Panel"===item.SubType&&(switchclick='onclick="showPanel()"');var HumidityStatus={Wet:"Humide",Comfortable:"Confortable",ccc:"333"};if("Closed"!==vdata||"Contact"!==item.SwitchType&&"Door Lock"!==item.SwitchType?"Open"!==vdata||"Contact"!==item.SwitchType&&"Door Lock"!==item.SwitchType?"undefined"!=typeof HumidityStatus[vdata]?vdata=HumidityStatus[vdata]:"DirectionStr"===vtype&&(vdata=vdata.replace(new RegExp("W","g"),"O")):(vdata=txt_open,vattr="color:#1B9772"):(vdata=txt_closed,vattr="color:#E24E2A"),"Off"!==vdata&&"Doorbell"!==item.SwitchType||"Selector"==item.SwitchType||(switchclick=['onclick="SwitchToggle(',item.idx,", 'On' ,",txt_switch_on,",",item.Protected,')"'].join(""),"Push On Button"===item.SwitchType&&"2"!=lastseen&&"3"!=lastseen?(vdata=vdesc,vdesc=""):(vdata=txt_off,alarmcss="color:#E24E2A;")),"On"===vdata&&"Selector"!=item.SwitchType&&(switchclick=['onclick="SwitchToggle(',item.idx,", 'Off' ,",txt_switch_off,",",item.Protected,')"'].join(""),"Push Off Button"===item.SwitchType&&"2"!=lastseen&&"3"!=lastseen?(vdata=vdesc,vdesc=""):(vdata=txt_on,alarmcss="color:#1B9772;")),"ForecastStr"!==vtype&&"undefined"!=typeof lastseen)if("2"===lastseen||"3"===lastseen){if("Dusk Sensor"===item.SwitchType)var icon_On="uvdark.png",icon_Off="uvsunny.png";else if("Door Lock"===item.SwitchType)var icon_On="door48open.png",icon_Off="door48.png";else if("Doorbell"===item.SwitchType)var icon_Off="doorbell48.png";else if("Contact"===item.SwitchType)var icon_On="contact48_open.png",icon_Off="contact48.png";else if("Motion Sensor"===item.SwitchType)var icon_On="motion48-on.png",icon_Off="motion48-off.png";else if("Push On Button"===item.SwitchType)var icon_Off="push48.png";else if("Push Off Button"===item.SwitchType)var icon_On="pushoff48.png";else if("Smoke Detector"===item.SwitchType)var icon_On="smoke48on.png",icon_Off="smoke48off.png";else if("Security Panel"===item.SubType){vdesc=vdata;var icon="security48.png";"Normal"===vdata?vdata=["<img src=",$.domoticzurl,"/images/",icon,"  width=48>"].join(""):"Arm Home"===vdata?vdata=["<img src=",$.domoticzurl,"/images/",icon,"  width=48>"].join(""):"Arm Away"===vdata&&(vdata=["<img src=",$.domoticzurl,"/images/",icon,"  width=48>"].join(""))}else if("Alert"===item.SubType){var icon_On=["Alert48_",vdata,".png"].join("");vdata=txt_on}else var icon_On=[item.Image,"48_On.png"].join(""),icon_Off=[item.Image,"48_Off.png"].join("");vdata===txt_on||vdata===txt_open?vdata=["<img src=",$.domoticzurl,"/images/",icon_On," width=48>"].join(""):vdata===txt_off||vdata===txt_closed?vdata=["<img src=",$.domoticzurl,"/images/",icon_Off,"  width=48>"].join(""):"Level"===vtype&&"Selector"===item.SwitchType&&(vdata=["<img src=icons/",vdata.replace(/ /g,"%20"),".png width=48>"].join(""))}else"0"!==lastseen&&"1"!==lastseen&&(vdata===txt_on||vdata===txt_open?vdata=["<img src=icons/",lastseen,"48_On.png width=48>"].join(""):vdata===txt_off||vdata===txt_closed?vdata=["<img src=icons/",lastseen,"48_Off.png width=48>"].join(""):"Push On Button"!==item.SwitchType&&"Push Off Button"!==item.SwitchType||(vdata=["<img src=icons/",lastseen,".png width=48>"].join(""),vdesc=$.PageArray[ii][3]));if("undefined"!=typeof valarm&&"SetPoint"!==vtype&&"Graph"!==vtype&&(eval(valarm.replace(/x/g,"Number(vdata)"))?(alarmcss="color:red;",blink&&!$("#"+vlabel).hasClass("blink_me")&&$("#"+vlabel).addClass("blink_me")):$("#"+vlabel).hasClass("blink_me")&&$("#"+vlabel).removeClass("blink_me")),"Temp"===vtype||"Chill"===vtype||"DewPoint"===vtype){var vtemp="T00";parseInt(vdata,10)>=0?vtemp=["T"+parseInt(vdata,10)]:parseInt(vdata,10)>=35&&(vtemp="T35"),switchclick=['class="',vtemp,"\" onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','temp','day','te','Température &#8451;')\""].join(""),vdata=[vdata,'<sup style="font-size:50%;" >&#8451;</sup>'].join("")}else"Humidity"===vtype?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','temp','day','hu','Humidité &#37;')\""].join(""),vdata=[vdata,'<span style="font-size:50%;" > &#37;</span>'].join("")):"Barometer"===vtype?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','temp','day','ba','Baromètre hpa')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> hPa</span>'].join("")):"Speed"===vtype||"Gust"===vtype?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','wind','day','sp','Vitesse km/h')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> km/h</span>'].join("")):"RainRate"===vtype?(switchclick=['onclick="RefreshGraphData(',item.idx,",'",vdesc,"','rainrate','day','mm/h','Précipitations mm/h')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> mm/h</span>'].join("")):"Rain"===item.Type?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','rain','day','mm','Précipitations mm')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> mm</span>'].join("")):"UV"===item.Type?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','uv','day','uvi','UV (uvi)')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> UVI</span>'].join("")):"Lux"===item.Type?vdata=[vdata,'<span style="font-size:50%;"> lx</span>'].join(""):"Data"!==vtype||"Percentage"!==item.SubType&&"Leaf Wetness"!==item.SubType?"Usage"!==vtype&&"Data"!==vtype||"Energy"!==item.SubType&&"CM119 / CM160"!==item.SubType&&"CM180"!==item.SubType&&"kWh"!==item.SubType&&"Electric"!==item.SubType?"CounterToday"!==vtype&&"Data"!==vtype||"Energy"!==item.SubType&&"CM119 / CM160"!==item.SubType&&"CM180"!==item.SubType&&"kWh"!==item.SubType&&"Electric"!==item.SubType&&"RFXMeter counter"!==item.SubType?"Counter"!==vtype&&"Data"!==vtype||"Energy"!==item.SubType&&"CM119 / CM160"!==item.SubType&&"CM180"!==item.SubType&&"kWh"!==item.SubType&&"Electric"!==item.SubType?"Euro"===vtype?vdata=[Math.ceil(100*vdata)/100,'<span style="font-size:50%;"> &#8364;</span>'].join(""):"Counter Incremental"!==item.Type&&"RFXMeter"!==item.Type||"1"!=item.SwitchTypeVal&&"2"!=item.SwitchTypeVal?"Counter Incremental"!==item.Type||"0"!=item.SwitchTypeVal&&"4"!=item.SwitchTypeVal?"Solar Radiation"===item.SubType?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter','day','v','Radiations W/m&#178;')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> W/m&#178;</span>'].join("")):"Visibility"===item.SubType?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter','day','v','Visibilité Km')\""].join(""),vdata=[vdata,'<span style="font-size:50%;"> km</span>'].join("")):"RFXMeter"===item.Type&&"3"==item.SwitchTypeVal?switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter','day','v','Compteur')\""].join(""):"Voltage"!==vtype&&"Voltage"!==item.SubType||(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter','day','v','Tension V')\""].join(""),vdata=[Math.ceil(100*vdata)/100,'<span style="font-size:50%;"> V</span>'].join("")):vdata=[vdata,'<span style="font-size:50%;"> kWh</span>'].join(""):("Data"!==vtype&&"Counter"!==vtype||(vdata=[vdata,'<span style="font-size:50%;"> m&#179;</span>'].join("")),"CounterToday"===vtype&&(vdata=[vdata,'<span style="font-size:50%;"> L</span>'].join(""))):vdata=[Math.ceil(vdata),'<span style="font-size:50%;"> kWh</span>'].join(""):vdata=[Math.ceil(10*vdata)/10,'<span style="font-size:50%;"> kWh</span>'].join(""):"P1 Smart Meter"===item.Type?(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter','day','p1','Electricité Watt')\""].join(""),vdata=[Math.ceil(vdata),'<span style="font-size:50%;"> Watt</span>'].join("")):(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','counter&method=1','day','v','Electricité Watt')\""].join(""),vdata=[Math.ceil(vdata),'<span style="font-size:50%;"> Watt</span>'].join("")):(switchclick=["onclick=\"RefreshGraphData('#popup_graph',",item.idx,",'",vdesc,"','Percentage','day','v','Pourcentage &#37;')\""].join(""),vdata=[Math.ceil(vdata),'<span style="font-size:50%;"> &#37;</span>'].join(""));"Graph"!==vtype&&("undefined"!=typeof alarmcss&&"undefined"==typeof vattr?$(["#",vlabel].join("")).html(["<span ",switchclick," style=",alarmcss,">",vdata,"</span>"].join("")):"undefined"!=typeof alarmcss&&"undefined"!=typeof vattr?$(["#",vlabel].join("")).html(["<span ",switchclick," style=",vattr,";",alarmcss,">",vdata,"</span>"].join("")):"undefined"==typeof alarmcss&&"undefined"!=typeof vattr?$(["#",vlabel].join("")).html(["<span ",switchclick," style=",vattr,";>",vdata,"</span>"].join("")):"undefined"==typeof alarmcss&&"undefined"==typeof vattr&&$(["#",vlabel].join("")).html(["<span ",switchclick,">",vdata,"</span>"].join(""))),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).html(vdesc)}else if("Text"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdesc=$.PageArray[ii][3],vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",vdesc,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty()}else if("FreeRemote"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdesc=$.PageArray[ii][3];$(["#",vlabel].join("")).html('<img src="icons/freeRemote.png" width=48 height=48 onclick="showFreeRemote()"></img>'),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).html(vdesc)}else if("Hide"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2];$(["#",vlabel].join("")).empty(),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty()}else if("Html"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdata=$.PageArray[ii][3];$(["#",vlabel].join("")).html(vdata),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty()}else if("Clock"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdata=currentTime(),vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",vdata,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty();
}else if("Date"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdata=currentDate(),vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",vdata,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty()}else if("MonthYear"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vdata=currentMonthYear(),vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",vdata,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).empty()}else if("SunRise"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",var_sunrise,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).html(txt_sunrise)}else if("SunSet"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,">",var_sunset,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).html(txt_sunset)}else if("SunBoth"===$.PageArray[ii][1]){var vlabel=$.PageArray[ii][2],vattr=$.PageArray[ii][6];$(["#",vlabel].join("")).html(["<span style=",vattr,'><img src=icons/sun.png  height="15" width="15" style="PADDING-RIGHT: 2px;">',var_sunrise,'<img src=icons/moon.png  height="15" width="15" style="PADDING-LEFT: 15px;">',var_sunset,"</span>"].join("")),$(["#desc_",vlabel].join("")).length>0&&$(["#desc_",vlabel].join("")).html(txt_sunboth)}})},{releaseObjects:!0}),two=new Date-two,console.log("Get switchs: "+two+"ms")}}),$.ajax({url:[$.domoticzurl,"/json.htm?type=scenes&plan=",$.roomplan,"&jsoncallback=?"].join(""),success:function(a){var b=new Date;"undefined"!=typeof a.result&&$.each(a.result,function(a,b){var c=0,d=$.PageArray_Scenes.length;jsKata.nofreeze.forloop(function(){return c<d-1},function(){c++},function(){if($.PageArray_Scenes[c][0]===b.idx||$.PageArray_Scenes[c][0]===b.Name){var d=$.PageArray_Scenes[c][1],e=$.PageArray_Scenes[c][2],f=$.PageArray_Scenes[c][3],g=$.PageArray_Scenes[c][4],h=$.PageArray_Scenes[c][5],i=b[d];"undefined"==typeof i?i="?!":(i=String(i).split("Watt",1)[0],i=String(i).split("kWh",1)[0]);var j,k,l,m;if("Off"===i||"Scene"===b.Type?(j=['onclick="SceneToggle(',b.idx,", 'On',",txt_switch_on,",",b.Protected,')"'].join(""),"Scene"===b.Type?(i=f,f=""):(i=txt_off,k="color:#E24E2A;")):"On"===i?(j=['onclick="SceneToggle(',b.idx,", 'Off',",txt_switch_off,",",b.Protected,')"'].join(""),k="color:#1B9772;",i=txt_on):"Mixed"===i&&(l=['<span style="font-size:100%;position:relative;left:-10px;color:#1B9772;" onclick="SceneToggle(',b.idx,", 'On',",txt_switch_on,",",b.Protected,')">',txt_on,"</span>"].join(""),m=['<span  style="font-size:100%;position:relative;left:10px;color:#E24E2A;" onclick="SceneToggle(',b.idx,", 'Off',",txt_switch_off,",",b.Protected,')">',txt_off,"</span>"].join(""),i=[l,m].join("")),isNaN(g)&&"undefined"!=typeof g){var n=[g,"48_On.png"].join(""),o=[g,"48_Off.png"].join("");"Blinds"===g&&(n="blindsopen48sel.png",o="blinds48sel.png"),"Scene"===b.Type?(f=$.PageArray_Scenes[c][3],i=['<img src="icons/',g.replace(/ /g,"%20"),'.png" width=48>'].join("")):i===txt_on?i=['<img src="',$.domoticzurl,"/images/",n,'" width=48>'].join(""):i===txt_off?i=['<img src="',$.domoticzurl,"/images/",o,'"  width=48>'].join(""):(l=['<img src="',$.domoticzurl,"/images/",n,'"  hspace=10 width=48 onclick="SceneToggle(',b.idx,", 'On',",txt_switch_on,",",b.Protected,')">'].join(""),m=['<img src="',$.domoticzurl,"/images/",o,'"  hspace=10 width=48 onclick="SceneToggle(',b.idx,", 'Off',",txt_switch_off,",",b.Protected,')">'].join(""),i=[l,m].join(""))}"undefined"!=typeof k&&"undefined"==typeof h?$(["#",e].join("")).html(["<span ",j," style=",k,">",i,"</span>"].join("")):"undefined"!=typeof k&&"undefined"!=typeof h?$(["#",e].join("")).html(["<span ",j," style=",h,";",k,">",i,"</span>"].join("")):"undefined"==typeof k&&"undefined"!=typeof h?$(["#",e].join("")).html(["<span ",j," style=",h,";>",i,"</span>"].join("")):"undefined"==typeof k&&"undefined"==typeof h&&$(["#",e].join("")).html(["<span ",j,">",i,"</span>"].join("")),$(["#desc_",e].join("")).length>0&&$(["#desc_",e].join("")).html(f)}})},{releaseObjects:!0}),b=new Date-b,console.log("Get scenes/groups: "+b+"ms")}}),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=getuservariables&jsoncallback=?"].join(""),success:function(a){var b=new Date;"undefined"!=typeof a.result&&$.each(a.result,function(a,b){var c=0,d=$.PageArray_UserVariable.length;jsKata.nofreeze.forloop(function(){return c<d-1},function(){c++},function(){if($.PageArray_UserVariable[c][0]===b.idx||$.PageArray_UserVariable[c][0]===b.Name){var d=$.PageArray_UserVariable[c][1],e=$.PageArray_UserVariable[c][2],f=$.PageArray_UserVariable[c][3],g=$.PageArray_UserVariable[c][4],h=b[d];"undefined"==typeof h&&(h="?!"),"undefined"==typeof g?$(["#",e].join("")).html(["<span>",h,"</span>"].join("")):$(["#",e].join("")).html(["<span style=",g,">",h,"</span>"].join("")),$(["#desc_",e].join("")).length>0&&$(["#desc_",e].join("")).html(f)}})},{releaseObjects:!0}),b=new Date-b,console.log("Get user variable : "+b+"ms")}}),refreshTimer=setTimeout(RefreshData,refresh)}function GetCams(){var a=0,b=$.PageArray.length;jsKata.nofreeze.forloop(function(){return a<b-1},function(){a++},function(){if("Camera"===$.PageArray[a][1]){var c=$.PageArray[a][2],d=$.PageArray[a][3],e=$.PageArray[a][4];""!==e&&"undefined"!=typeof e||(e=[location.href.replace("index.html","").replace(/\/$/,""),"/icons/offline.jpg"].join("")),$(["#",c].join("")).html(["<img src=",d," alt=",e," class='camera' >"].join("")),$(["#",c," img"].join("")).on("error",function(){console.log("vlabel: "+this.parentNode.className),console.log("on error: "+this.src),this.onerror=null,this.src===this.alt?this.src=[location.href.replace("index.html","").replace(/\/$/,""),"/icons/offline.jpg"].join(""):this.src=this.alt,console.log("replace: "+this.src)}),$(["#",c," img"].join("")).click(function(){$("#popup_camera").html(["<img src=",this.src," >"].join("")),lightbox_open("camera",25400)}),$(["#desc_",c].join("")).length>0&&$(["#desc_",c].join("")).empty()}})}function SceneToggle(a,b,c,d){var e;d&&(e=prompt("Mot de pass"),null===e)||$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchscene&idx=",a,"&switchcmd=",b,"&level=0&passcode=",e].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),0!==switch_timeout&&lightbox_open("switch",switch_timeout,c),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}function SwitchToggle(a,b,c,d){var e;d&&(e=prompt("Mot de pass"),null===e)||$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",a,"&switchcmd=",b,"&level=0&passcode=",e].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),0!==switch_timeout&&lightbox_open("switch",switch_timeout,c),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}function DimLevel16(a,b,c,d,e){var f;if(!e||(f=prompt("Mot de pass"),null!==f))if(b===txt_off)1===d&&d++,$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",c,"&switchcmd=Set Level&level=",d,"&passcode=",f].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}});else if(b*=1,"plus"===a){var g=(b+10)/100*16+.5;g>16&&(g=16),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",c,"&switchcmd=Set Level&level=",g,"&passcode=",f].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}else{var g=(b-.1)/100*16;g<0&&(g=0),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",c,"&switchcmd=Set Level&level=",g,"&passcode=",f].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}}function DimLevel100(a,b,c,d){var e;if(!d||(e=prompt("Mot de pass"),null!==e))if("plus"===a){var f=b+10;f>100&&(f=100),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",c,"&switchcmd=Set Level&level=",f,"&passcode=",e].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}else{var f=b-10;f<0&&(f=0),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",c,"&switchcmd=Set Level&level=",f,"&passcode=",e].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}}function ChangeTherm(a,b,c,d,e,f){var g;if(!f||(g=prompt("Mot de pass"),null!==g)){var h="";"plus"===a?h=d+b>e?e:d+b:"min"===a&&(h=d<b?1:d-b),$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=udevice&idx=",c,"&nvalue=0&svalue=",h,"&passcode=",g].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}}function currentTime(){var a=new Date,b=a.getHours().toString();b=b.trim(),1===b.length&&(b="0"+b);var c=a.getMinutes().toString();c=c.trim(),1===c.length&&(c="0"+c);var d=days[a.getDay().toString()],e=a.getDate().toString();e=e.trim(),1===e.length&&(e="0"+e);var f=months[a.getMonth().toString()];if(showMonth)var g=['<span style="font-size:120%;position:relative;top:-5px;">',b,":",c,'</span><br><span style="font-size:35%;position:relative;top:-40px;">',d," ",e," ",f,"</span>"].join("");else var g=['<span style="font-size:120%;position:relative;top:-5px;">',b,":",c,'</span><br><span style="font-size:35%;position:relative;top:-40px;">',d," ",e,"</span>"].join("");return g}function currentDate(){var a=new Date,b=days[a.getDay().toString()],c=a.getDate().toString();c=c.trim(),1===c.length&&(c="0"+c);var d=months[a.getMonth().toString()];if(showMonth)var e=['<span style="font-size:50%;">',b," ",c," ",d,"</span>"].join("");else var e=['<span style="font-size:50%;">',b," ",c,"</span>"].join("");return e}function currentMonthYear(){var a=new Date,b=months[a.getMonth().toString()],c=a.getFullYear().toString(),d=['<span style="font-size:60%;position:relative;top:-5px;">',b,'</span><br><span style="font-size:55%;position:relative;top:-40px;">',c,"</span>"].join("");return d}function goodmorning(a){var b=a.substring(0,2),c=a.substring(3,5),d=a.substring(8,10),e=days[a.substring(6,7)-1],f=months[a.substring(11,13).replace(/^0+/,"")-1],g=a.substring(14,18),h=new Date,i=new Date(g,a.substring(11,13).replace(/^0+/,"")-1,d,b,c);if(showMonth)var j=['<span style="font-size:100%;position:relative;top:-5px;">',b,":",c,'</span><br><span style="font-size:35%;position:relative;top:-40px;">',e," ",d," ",f,"</span>"].join("");else var j=['<span style="font-size:100%;position:relative;top:-5px;">',b,":",c,'</span><br><span style="font-size:35%;position:relative;top:-40px;">',e," ",d,"</span>"].join("");if(h>i)var j="<img src=icons/sleep.png  height='70' width='70'>";return j}function ShowSelector(a,b,c,d){var e=b.split("|");for($("#popup_selector").html(""),i=0;i<e.length;i++)(c&&"Off"!=e[i]||!c)&&$("#popup_selector").append(['<span onclick="SwitchSelector(',a,",",10*i,",",d,')">',e[i],"</span><br>"].join(""));lightbox_open("selector",25e3)}function SwitchSelector(a,b,c){var d;c&&(d=prompt("Mot de pass"),null===d)||$.ajax({url:[$.domoticzurl,"/json.htm?type=command&param=switchlight&idx=",a,"&switchcmd=Set%20Level&level=",b,"&passcode=",d].join(""),success:function(a){"WRONG CODE"===a.message?(console.warn("WRONG CODE"),lightbox_open("switch",wrongCode_timeout,txt_wrong_code)):"OK"===a.status?(console.log("%cSend command : Succes","color:green"),RefreshData()):(lightbox_open("switch",1500,a.status),console.log(a))},error:function(a){lightbox_open("switch",1500,a.statusText),console.warn(a.status)}})}function rss(a){$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q="+encodeURIComponent(a),success:function(a){a.responseData.feed&&a.responseData.feed.entries&&$.each(a.responseData.feed.entries,function(a,b){console.log("------------------------"),console.log("title      : "+b.title),console.log("author     : "+b.author),console.log("description: "+b.description)})}})}console.log("\n","\n","\n"),console.log("%cWellcome on Monitor for Domoticz","color: blue; font-size:25px;","\n"),console.log("%c    Big thanks to all contributors..","color: blue; font-size:19px;","\n","\n","\n"),debug||(console.log=function(){}),$(function(){setTimeout(RefreshData,150),setTimeout(GetCams,1e3),setTimeout(LoadMeteoWidget,3e3),setTimeout(function(){location.reload()},36e5)}),document.onselectstart="return false",window.sidebar&&(document.onmousedown=ffalse,document.onclick=ftrue),$.ajaxSetup({dataType:"json",async:!0,global:!1,timeout:connectTimeout,cache:!1});var tempo,var_sunrise,var_sunset,IsNight=!1,error=0,timer,istrue=!1,delay=100,refreshTimer;